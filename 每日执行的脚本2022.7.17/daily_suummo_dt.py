

# title	_6code
# 千代田区	131016
# 中央区	131024
# 港区	131032
# 新宿区	131041
# 文京区	131059
# 台東区	131067
# 墨田区	131075
# 江東区	131083
# 品川区	131091
# 目黒区	131105
# 大田区	131113
# 世田谷区	131121
# 渋谷区	131130
# 中野区	131148
# 杉並区	131156
# 豊島区	131164
# 北区	131172
# 荒川区	131181
# 板橋区	131199
# 練馬区	131202
# 足立区	131211
# 葛飾区	131229
# 江戸川区	131237
import re
import time

import pandas as pd
import requests
import pymysql
from lxml import etree

import re
import json
import time
from lxml import etree
from selenium import webdriver
import pymysql
driver = webdriver.Chrome()




def use_selenium_headless_getdt(url):
    driver.get(url)
    html = driver.page_source
    return html





def insertDB(content,tablename):


    connection = pymysql.connect(host='127.0.0.1', port=3306, user='root', password='123456', db='JP_RealEstate',
                                 charset='utf8mb4', cursorclass=pymysql.cursors.DictCursor)

    cursor = connection.cursor()
    try:

        f_6 = "%s," *480
        cursor.executemany('insert into {1} (_131202_2,_131202_3,_131202_4,_131202_5,_131202_6,_131202_7,_131202_8,_131202_9,_131202_10,_131202_11,_131202_12,_131202_13,_131202_14,_131202_15,_131202_16,_131202_17,_131202_18,_131105_1,_131105_2,_131105_3,_131105_4,_131105_5,_131105_6,_131105_7,_131105_8,_131105_9,_131075_1,_131075_2,_131075_3,_131075_4,_131075_5,_131075_6,_131075_7,_131075_8,_131075_9,_131075_10,_131075_11,_131075_12,_131075_13,_131172_1,_131172_2,_131172_3,_131172_4,_131172_5,_131172_6,_131172_7,_131172_8,_131172_9,_131172_10,_131172_11,_131172_12,_131172_13,_131172_14,_131172_15,_131172_16,_131172_17,_131172_18,_131164_1,_131164_2,_131164_3,_131164_4,_131164_5,_131164_6,_131164_7,_131164_8,_131164_9,_131164_10,_131164_11,_131164_12,_131164_13,_131164_14,_131164_15,_131164_16,_131164_17,_131164_18,_131164_19,_131164_20,_131164_21,_131164_22,_131164_23,_131164_24,_131059_1,_131059_2,_131059_3,_131059_4,_131059_5,_131059_6,_131059_7,_131059_8,_131059_9,_131059_10,_131059_11,_131059_12,_131059_13,_131059_14,_131059_15,_131091_1,_131091_2,_131091_3,_131091_4,_131091_5,_131091_6,_131091_7,_131091_8,_131091_9,_131091_10,_131091_11,_131091_12,_131091_13,_131091_14,_131091_15,_131091_16,_131091_17,_131091_18,_131091_19,_131091_20,_131091_21,_131091_22,_131091_23,_131091_24,_131091_25,_131091_26,_131199_1,_131199_2,_131199_3,_131199_4,_131199_5,_131199_6,_131199_7,_131199_8,_131199_9,_131199_10,_131199_11,_131199_12,_131199_13,_131199_14,_131199_15,_131199_16,_131199_17,_131199_18,_131199_19,_131199_20,_131199_21,_131199_22,_131148_1,_131148_2,_131148_3,_131148_4,_131148_5,_131148_6,_131148_7,_131148_8,_131148_9,_131148_10,_131148_11,_131148_12,_131148_13,_131024_1,_131024_2,_131024_3,_131024_4,_131024_5,_131024_6,_131024_7,_131024_8,_131024_9,_131024_10,_131024_11,_131024_12,_131024_13,_131024_14,_131024_15,_131024_16,_131024_17,_131024_18,_131024_19,_131024_20,_131024_21,_131024_22,_131113_1,_131113_2,_131113_3,_131113_4,_131113_5,_131113_6,_131113_7,_131113_8,_131113_9,_131113_10,_131113_11,_131113_12,_131113_13,_131113_14,_131113_15,_131113_16,_131113_17,_131113_18,_131113_19,_131113_20,_131113_21,_131113_22,_131113_23,_131113_24,_131113_25,_131113_26,_131113_27,_131113_28,_131113_29,_131113_30,_131113_31,_131113_32,_131113_33,_131113_34,_131113_35,_131113_36,_131113_37,_131113_38,_131211_1,_131211_2,_131211_3,_131211_4,_131211_5,_131211_6,_131211_7,_131211_8,_131211_9,_131211_10,_131211_11,_131211_12,_131211_13,_131211_14,_131211_15,_131211_16,_131211_17,_131211_18,_131211_19,_131211_20,_131211_21,_131211_22,_131211_23,_131211_24,_131016_1,_131016_2,_131016_3,_131016_4,_131016_5,_131016_6,_131016_7,_131016_8,_131016_9,_131016_10,_131016_11,_131016_12,_131016_13,_131016_14,_131016_15,_131016_16,_131016_17,_131016_18,_131016_19,_131121_1,_131121_2,_131121_3,_131121_4,_131121_5,_131121_6,_131121_7,_131121_8,_131121_9,_131121_10,_131121_11,_131121_12,_131121_13,_131121_14,_131121_15,_131121_16,_131121_17,_131121_18,_131121_19,_131121_20,_131121_21,_131121_22,_131121_23,_131121_24,_131121_25,_131121_26,_131121_27,_131121_28,_131121_29,_131121_30,_131121_31,_131121_32,_131121_33,_131121_34,_131121_35,_131121_36,_131121_37,_131121_38,_131156_1,_131156_2,_131156_3,_131156_4,_131156_5,_131156_6,_131156_7,_131156_8,_131156_9,_131156_10,_131156_11,_131156_12,_131156_13,_131156_14,_131156_15,_131156_16,_131156_17,_131156_18,_131041_1,_131041_2,_131041_3,_131041_4,_131041_5,_131041_6,_131041_7,_131041_8,_131041_9,_131041_10,_131041_11,_131041_12,_131041_13,_131041_14,_131041_15,_131041_16,_131041_17,_131041_18,_131041_19,_131041_20,_131041_21,_131041_22,_131041_23,_131041_24,_131041_25,_131041_26,_131041_27,_131130_1,_131130_2,_131130_3,_131130_4,_131130_5,_131130_6,_131130_7,_131130_8,_131130_9,_131130_10,_131130_11,_131130_12,_131130_13,_131130_14,_131130_15,_131130_16,_131130_17,_131130_18,_131181_1,_131181_2,_131181_3,_131181_4,_131181_5,_131181_6,_131181_7,_131181_8,_131181_9,_131181_10,_131181_11,_131181_12,_131181_13,_131181_14,_131181_15,_131181_16,_131181_17,_131181_18,_131181_19,_131032_1,_131032_2,_131032_3,_131032_4,_131032_5,_131032_6,_131032_7,_131032_8,_131032_9,_131032_10,_131032_11,_131032_12,_131032_13,_131032_14,_131032_15,_131032_16,_131032_17,_131032_18,_131032_19,_131032_20,_131032_21,_131032_22,_131032_23,_131032_24,_131032_25,_131032_26,_131032_27,_131032_28,_131032_29,_131032_30,_131032_31,_131032_32,_131032_33,_131032_34,_131237_1,_131237_2,_131237_3,_131237_4,_131237_5,_131237_6,_131237_7,_131237_8,_131237_9,_131237_10,_131237_11,_131229_1,_131229_2,_131229_3,_131229_4,_131229_5,_131229_6,_131229_7,_131229_8,_131229_9,_131229_10,_131229_11,_131229_12,_131083_1,_131083_2,_131083_3,_131083_4,_131083_5,_131083_6,_131083_7,_131083_8,_131083_9,_131083_10,_131083_11,_131083_12,_131083_13,_131083_14,_131083_15,_131083_16,_131083_17,_131083_18,_131083_19,_131083_20,_131083_21,_131083_22,_131083_23,_131083_24,_131083_25,_131083_26,_131083_27,_131083_28,_131083_29,_131083_30,_131083_31,_131083_32,_131083_33,_131083_34,_131083_35,_131083_36,_131083_37,_131083_38,_131083_39,_131083_40,_131083_41,_131083_42,_131083_43) values ({0})'.format(f_6[:-1],tablename), content)
        connection.commit()
        connection.commit()
        connection.close()
        print('向MySQL中添加数据成功！')
    except TypeError :
        pass




if __name__ == "__main__":
    _data_list = []

    file_dt = pd.read_excel("line_station_area.xlsx")
    for item in file_dt.values.tolist():
        url = item[3]
        res = use_selenium_headless_getdt(url)

        one_station_dt = re.findall(re.compile('paginate_set-hit">(.*?)<span>件</span>', re.S),
                                    res)
        print(one_station_dt)
        if len(one_station_dt) ==0:
            one_station_dt=["0"]
        _data_ = "".join([re.findall(re.compile('\d+', re.S), x) for x in one_station_dt][0])
        print(_data_,url)
        print(_data_list)
        _data_list.append(_data_)
    ff_l = []
    print(len(_data_list))
    f_tup = tuple(_data_list)
    ff_l.append((f_tup))
    print(ff_l)
    insertDB(ff_l, "daily_suummo_dt")
    driver.close()







#_line,_station,_area,_10minutes_URL

# SET SESSION innodb_strict_mode = OFF;
# create table daily_suummo_dt (id int not null primary key auto_increment,_131202_2 BLOB,_131202_3 BLOB,_131202_4 BLOB,_131202_5 BLOB,_131202_6 BLOB,_131202_7 BLOB,_131202_8 BLOB,_131202_9 BLOB,_131202_10 BLOB,_131202_11 BLOB,_131202_12 BLOB,_131202_13 BLOB,_131202_14 BLOB,_131202_15 BLOB,_131202_16 BLOB,_131202_17 BLOB,_131202_18 BLOB,_131105_1 BLOB,_131105_2 BLOB,_131105_3 BLOB,_131105_4 BLOB,_131105_5 BLOB,_131105_6 BLOB,_131105_7 BLOB,_131105_8 BLOB,_131105_9 BLOB,_131075_1 BLOB,_131075_2 BLOB,_131075_3 BLOB,_131075_4 BLOB,_131075_5 BLOB,_131075_6 BLOB,_131075_7 BLOB,_131075_8 BLOB,_131075_9 BLOB,_131075_10 BLOB,_131075_11 BLOB,_131075_12 BLOB,_131075_13 BLOB,_131172_1 BLOB,_131172_2 BLOB,_131172_3 BLOB,_131172_4 BLOB,_131172_5 BLOB,_131172_6 BLOB,_131172_7 BLOB,_131172_8 BLOB,_131172_9 BLOB,_131172_10 BLOB,_131172_11 BLOB,_131172_12 BLOB,_131172_13 BLOB,_131172_14 BLOB,_131172_15 BLOB,_131172_16 BLOB,_131172_17 BLOB,_131172_18 BLOB,_131164_1 BLOB,_131164_2 BLOB,_131164_3 BLOB,_131164_4 BLOB,_131164_5 BLOB,_131164_6 BLOB,_131164_7 BLOB,_131164_8 BLOB,_131164_9 BLOB,_131164_10 BLOB,_131164_11 BLOB,_131164_12 BLOB,_131164_13 BLOB,_131164_14 BLOB,_131164_15 BLOB,_131164_16 BLOB,_131164_17 BLOB,_131164_18 BLOB,_131164_19 BLOB,_131164_20 BLOB,_131164_21 BLOB,_131164_22 BLOB,_131164_23 BLOB,_131164_24 BLOB,_131059_1 BLOB,_131059_2 BLOB,_131059_3 BLOB,_131059_4 BLOB,_131059_5 BLOB,_131059_6 BLOB,_131059_7 BLOB,_131059_8 BLOB,_131059_9 BLOB,_131059_10 BLOB,_131059_11 BLOB,_131059_12 BLOB,_131059_13 BLOB,_131059_14 BLOB,_131059_15 BLOB,_131091_1 BLOB,_131091_2 BLOB,_131091_3 BLOB,_131091_4 BLOB,_131091_5 BLOB,_131091_6 BLOB,_131091_7 BLOB,_131091_8 BLOB,_131091_9 BLOB,_131091_10 BLOB,_131091_11 BLOB,_131091_12 BLOB,_131091_13 BLOB,_131091_14 BLOB,_131091_15 BLOB,_131091_16 BLOB,_131091_17 BLOB,_131091_18 BLOB,_131091_19 BLOB,_131091_20 BLOB,_131091_21 BLOB,_131091_22 BLOB,_131091_23 BLOB,_131091_24 BLOB,_131091_25 BLOB,_131091_26 BLOB,_131199_1 BLOB,_131199_2 BLOB,_131199_3 BLOB,_131199_4 BLOB,_131199_5 BLOB,_131199_6 BLOB,_131199_7 BLOB,_131199_8 BLOB,_131199_9 BLOB,_131199_10 BLOB,_131199_11 BLOB,_131199_12 BLOB,_131199_13 BLOB,_131199_14 BLOB,_131199_15 BLOB,_131199_16 BLOB,_131199_17 BLOB,_131199_18 BLOB,_131199_19 BLOB,_131199_20 BLOB,_131199_21 BLOB,_131199_22 BLOB,_131148_1 BLOB,_131148_2 BLOB,_131148_3 BLOB,_131148_4 BLOB,_131148_5 BLOB,_131148_6 BLOB,_131148_7 BLOB,_131148_8 BLOB,_131148_9 BLOB,_131148_10 BLOB,_131148_11 BLOB,_131148_12 BLOB,_131148_13 BLOB,_131024_1 BLOB,_131024_2 BLOB,_131024_3 BLOB,_131024_4 BLOB,_131024_5 BLOB,_131024_6 BLOB,_131024_7 BLOB,_131024_8 BLOB,_131024_9 BLOB,_131024_10 BLOB,_131024_11 BLOB,_131024_12 BLOB,_131024_13 BLOB,_131024_14 BLOB,_131024_15 BLOB,_131024_16 BLOB,_131024_17 BLOB,_131024_18 BLOB,_131024_19 BLOB,_131024_20 BLOB,_131024_21 BLOB,_131024_22 BLOB,_131113_1 BLOB,_131113_2 BLOB,_131113_3 BLOB,_131113_4 BLOB,_131113_5 BLOB,_131113_6 BLOB,_131113_7 BLOB,_131113_8 BLOB,_131113_9 BLOB,_131113_10 BLOB,_131113_11 BLOB,_131113_12 BLOB,_131113_13 BLOB,_131113_14 BLOB,_131113_15 BLOB,_131113_16 BLOB,_131113_17 BLOB,_131113_18 BLOB,_131113_19 BLOB,_131113_20 BLOB,_131113_21 BLOB,_131113_22 BLOB,_131113_23 BLOB,_131113_24 BLOB,_131113_25 BLOB,_131113_26 BLOB,_131113_27 BLOB,_131113_28 BLOB,_131113_29 BLOB,_131113_30 BLOB,_131113_31 BLOB,_131113_32 BLOB,_131113_33 BLOB,_131113_34 BLOB,_131113_35 BLOB,_131113_36 BLOB,_131113_37 BLOB,_131113_38 BLOB,_131211_1 BLOB,_131211_2 BLOB,_131211_3 BLOB,_131211_4 BLOB,_131211_5 BLOB,_131211_6 BLOB,_131211_7 BLOB,_131211_8 BLOB,_131211_9 BLOB,_131211_10 BLOB,_131211_11 BLOB,_131211_12 BLOB,_131211_13 BLOB,_131211_14 BLOB,_131211_15 BLOB,_131211_16 BLOB,_131211_17 BLOB,_131211_18 BLOB,_131211_19 BLOB,_131211_20 BLOB,_131211_21 BLOB,_131211_22 BLOB,_131211_23 BLOB,_131211_24 BLOB,_131016_1 BLOB,_131016_2 BLOB,_131016_3 BLOB,_131016_4 BLOB,_131016_5 BLOB,_131016_6 BLOB,_131016_7 BLOB,_131016_8 BLOB,_131016_9 BLOB,_131016_10 BLOB,_131016_11 BLOB,_131016_12 BLOB,_131016_13 BLOB,_131016_14 BLOB,_131016_15 BLOB,_131016_16 BLOB,_131016_17 BLOB,_131016_18 BLOB,_131016_19 BLOB,_131121_1 BLOB,_131121_2 BLOB,_131121_3 BLOB,_131121_4 BLOB,_131121_5 BLOB,_131121_6 BLOB,_131121_7 BLOB,_131121_8 BLOB,_131121_9 BLOB,_131121_10 BLOB,_131121_11 BLOB,_131121_12 BLOB,_131121_13 BLOB,_131121_14 BLOB,_131121_15 BLOB,_131121_16 BLOB,_131121_17 BLOB,_131121_18 BLOB,_131121_19 BLOB,_131121_20 BLOB,_131121_21 BLOB,_131121_22 BLOB,_131121_23 BLOB,_131121_24 BLOB,_131121_25 BLOB,_131121_26 BLOB,_131121_27 BLOB,_131121_28 BLOB,_131121_29 BLOB,_131121_30 BLOB,_131121_31 BLOB,_131121_32 BLOB,_131121_33 BLOB,_131121_34 BLOB,_131121_35 BLOB,_131121_36 BLOB,_131121_37 BLOB,_131121_38 BLOB,_131156_1 BLOB,_131156_2 BLOB,_131156_3 BLOB,_131156_4 BLOB,_131156_5 BLOB,_131156_6 BLOB,_131156_7 BLOB,_131156_8 BLOB,_131156_9 BLOB,_131156_10 BLOB,_131156_11 BLOB,_131156_12 BLOB,_131156_13 BLOB,_131156_14 BLOB,_131156_15 BLOB,_131156_16 BLOB,_131156_17 BLOB,_131156_18 BLOB,_131041_1 BLOB,_131041_2 BLOB,_131041_3 BLOB,_131041_4 BLOB,_131041_5 BLOB,_131041_6 BLOB,_131041_7 BLOB,_131041_8 BLOB,_131041_9 BLOB,_131041_10 BLOB,_131041_11 BLOB,_131041_12 BLOB,_131041_13 BLOB,_131041_14 BLOB,_131041_15 BLOB,_131041_16 BLOB,_131041_17 BLOB,_131041_18 BLOB,_131041_19 BLOB,_131041_20 BLOB,_131041_21 BLOB,_131041_22 BLOB,_131041_23 BLOB,_131041_24 BLOB,_131041_25 BLOB,_131041_26 BLOB,_131041_27 BLOB,_131130_1 BLOB,_131130_2 BLOB,_131130_3 BLOB,_131130_4 BLOB,_131130_5 BLOB,_131130_6 BLOB,_131130_7 BLOB,_131130_8 BLOB,_131130_9 BLOB,_131130_10 BLOB,_131130_11 BLOB,_131130_12 BLOB,_131130_13 BLOB,_131130_14 BLOB,_131130_15 BLOB,_131130_16 BLOB,_131130_17 BLOB,_131130_18 BLOB,_131181_1 BLOB,_131181_2 BLOB,_131181_3 BLOB,_131181_4 BLOB,_131181_5 BLOB,_131181_6 BLOB,_131181_7 BLOB,_131181_8 BLOB,_131181_9 BLOB,_131181_10 BLOB,_131181_11 BLOB,_131181_12 BLOB,_131181_13 BLOB,_131181_14 BLOB,_131181_15 BLOB,_131181_16 BLOB,_131181_17 BLOB,_131181_18 BLOB,_131181_19 BLOB,_131032_1 BLOB,_131032_2 BLOB,_131032_3 BLOB,_131032_4 BLOB,_131032_5 BLOB,_131032_6 BLOB,_131032_7 BLOB,_131032_8 BLOB,_131032_9 BLOB,_131032_10 BLOB,_131032_11 BLOB,_131032_12 BLOB,_131032_13 BLOB,_131032_14 BLOB,_131032_15 BLOB,_131032_16 BLOB,_131032_17 BLOB,_131032_18 BLOB,_131032_19 BLOB,_131032_20 BLOB,_131032_21 BLOB,_131032_22 BLOB,_131032_23 BLOB,_131032_24 BLOB,_131032_25 BLOB,_131032_26 BLOB,_131032_27 BLOB,_131032_28 BLOB,_131032_29 BLOB,_131032_30 BLOB,_131032_31 BLOB,_131032_32 BLOB,_131032_33 BLOB,_131032_34 BLOB,_131237_1 BLOB,_131237_2 BLOB,_131237_3 BLOB,_131237_4 BLOB,_131237_5 BLOB,_131237_6 BLOB,_131237_7 BLOB,_131237_8 BLOB,_131237_9 BLOB,_131237_10 BLOB,_131237_11 BLOB,_131229_1 BLOB,_131229_2 BLOB,_131229_3 BLOB,_131229_4 BLOB,_131229_5 BLOB,_131229_6 BLOB,_131229_7 BLOB,_131229_8 BLOB,_131229_9 BLOB,_131229_10 BLOB,_131229_11 BLOB,_131229_12 BLOB,_131083_1 BLOB,_131083_2 BLOB,_131083_3 BLOB,_131083_4 BLOB,_131083_5 BLOB,_131083_6 BLOB,_131083_7 BLOB,_131083_8 BLOB,_131083_9 BLOB,_131083_10 BLOB,_131083_11 BLOB,_131083_12 BLOB,_131083_13 BLOB,_131083_14 BLOB,_131083_15 BLOB,_131083_16 BLOB,_131083_17 BLOB,_131083_18 BLOB,_131083_19 BLOB,_131083_20 BLOB,_131083_21 BLOB,_131083_22 BLOB,_131083_23 BLOB,_131083_24 BLOB,_131083_25 BLOB,_131083_26 BLOB,_131083_27 BLOB,_131083_28 BLOB,_131083_29 BLOB,_131083_30 BLOB,_131083_31 BLOB,_131083_32 BLOB,_131083_33 BLOB,_131083_34 BLOB,_131083_35 BLOB,_131083_36 BLOB,_131083_37 BLOB,_131083_38 BLOB,_131083_39 BLOB,_131083_40 BLOB,_131083_41 BLOB,_131083_42 BLOB,_131083_43 BLOB, LastTime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP) engine=InnoDB  charset=utf8;


#  drop table line_station_area;